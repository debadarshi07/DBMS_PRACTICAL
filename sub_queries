-- 1. Customer details with Account_no "A0004"
SELECT name, phone_no, cust_no 
FROM Customer 
WHERE account_no = 'A0004';

-- 2. Customers who have not taken any loan
SELECT name 
FROM Customer 
WHERE cust_no NOT IN (SELECT cust_no FROM Loan);

-- 3. Account details of customer with cust_no = "C0010"
SELECT account_no, balance 
FROM Account 
WHERE cust_no = 'C0010';

-- 4. Branch city where "ASLESHA TIWARI" has taken a loan
SELECT branch_city 
FROM Branch 
WHERE branch_id IN (SELECT branch_id FROM Loan WHERE cust_no IN (SELECT cust_no FROM Customer WHERE name = 'ASLESHA TIWARI'));

-- 5. Installment details of customer "ANKITA SINGH"
SELECT installment_no, installment_amount 
FROM Installment 
WHERE loan_no IN (SELECT loan_no FROM Loan WHERE cust_no IN (SELECT cust_no FROM Customer WHERE name = 'ANKITA SINGH'));

-- 6. Branch name and city where "ABHIJIT MISHRA" has an account
SELECT branch_name, branch_city 
FROM Branch 
WHERE branch_id IN (SELECT branch_id FROM Account WHERE cust_no IN (SELECT cust_no FROM Customer WHERE name = 'ABHIJIT MISHRA'));

-- 7. Create ACCOUNT_TYPE table
CREATE TABLE ACCOUNT_TYPE (
    ACCOUNT_NO VARCHAR(20),
    TYPE VARCHAR(20)
);

-- 8. Insert account no and type with balance < 50000
INSERT INTO ACCOUNT_TYPE (ACCOUNT_NO, TYPE)
SELECT account_no, type FROM Account WHERE balance < 50000;

-- 9. Update account type to FD for cust_no "C0007"
UPDATE ACCOUNT_TYPE 
SET TYPE = 'FD' 
WHERE ACCOUNT_NO IN (SELECT account_no FROM Account WHERE cust_no = 'C0007');

-- 10. Delete accounts with balance < 20000
DELETE FROM ACCOUNT_TYPE 
WHERE ACCOUNT_NO IN (SELECT account_no FROM Account WHERE balance < 20000);

-- 11. Accounts with balance greater than some FD accounts
SELECT account_no 
FROM Account 
WHERE balance > SOME (SELECT balance FROM Account WHERE type = 'FD');

-- 12. Accounts with balance greater than all FD accounts
SELECT account_no 
FROM Account 
WHERE balance > ALL (SELECT balance FROM Account WHERE type = 'FD');

-- 13. Branches where some loans are taken
SELECT * FROM Branch 
WHERE EXISTS (SELECT * FROM Loan WHERE Loan.branch_id = Branch.branch_id);

-- 14. Loans with no installments paid
SELECT * FROM Loan 
WHERE NOT EXISTS (SELECT * FROM Installment WHERE Installment.loan_no = Loan.loan_no);

-- 15. Increase balances with CASE statement
UPDATE Account 
SET balance = CASE 
    WHEN balance > 80000 THEN balance * 1.06 
    ELSE balance * 1.05 
END;

